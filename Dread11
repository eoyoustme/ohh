--[[ 
DreadClock Effect for Doors
Chạy LocalScript trong StarterPlayerScripts
Hiển thị GUI + âm thanh + giảm tốc WalkSpeed
--]]

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local gui = player:WaitForChild("PlayerGui")

--=== Tạo DreadClock Model ===--
local currentLoadedRoom = workspace.CurrentRooms:FindFirstChild(ReplicatedStorage.GameData.LatestRoom.Value)
if not currentLoadedRoom then return end

local omg = Instance.new("Model")
omg.Parent = currentLoadedRoom
omg.Name = "DreadClock"

local eyesAsset = game:GetObjects("rbxassetid://15033250482")[1]

local num = 0
if currentLoadedRoom:FindFirstChild("PathfindNodes") then
    num = math.floor(#currentLoadedRoom.PathfindNodes:GetChildren()/2)
end

local targetCFrame
if num == 0 then
    targetCFrame = currentLoadedRoom[currentLoadedRoom.Name].CFrame + Vector3.new(0,5,0)
else
    targetCFrame = currentLoadedRoom.PathfindNodes[num].CFrame + Vector3.new(0,5,0)
end

eyesAsset:PivotTo(targetCFrame)
eyesAsset.Parent = omg
if eyesAsset.PrimaryPart then
    eyesAsset.PrimaryPart.Anchored = true
end

--=== DreadClock Effect Function ===--
local function DreadClockEffect()
    -- GUI Overlay
    local img = Instance.new("ImageLabel")
    img.Parent = gui
    img.Size = UDim2.new(1,0,1,0)
    img.Position = UDim2.new(0,0,0,0)
    img.BackgroundTransparency = 1
    img.Image = "rbxassetid://17383555514"
    img.ImageTransparency = 0.8

    local dark = Instance.new("Frame")
    dark.Parent = gui
    dark.Size = UDim2.new(1,0,1,0)
    dark.BackgroundColor3 = Color3.fromRGB(0,80,130)
    dark.BackgroundTransparency = 1

    -- Sound
    local sound = Instance.new("Sound")
    -- Thay đổi assetid bằng audio Roblox hợp lệ
    sound.SoundId = "rbxassetid://1234567890" 
    sound.Volume = 1
    sound.Looped = true
    sound.Parent = workspace
    sound:Play()

    -- Giảm tốc WalkSpeed
    local char = player.Character or player.CharacterAdded:Wait()
    local humanoid = char:WaitForChild("Humanoid")
    local originalSpeed = humanoid.WalkSpeed

    local elapsed = 0
    local duration = 35
    local step = 2.5
    local toggle = false

    while elapsed < duration do
        elapsed += step

        -- Tween màu tối xanh
        TweenService:Create(dark, TweenInfo.new(0.4), {BackgroundTransparency = 0.7}):Play()
        task.wait(0.4)
        TweenService:Create(dark, TweenInfo.new(0.4), {BackgroundTransparency = 1}):Play()

        -- Giảm tốc
        humanoid.WalkSpeed = math.max(0, humanoid.WalkSpeed - 1)

        -- Đổi opacity ảnh
        toggle = not toggle
        TweenService:Create(img, TweenInfo.new(0.5), {ImageTransparency = toggle and 0.4 or 0.8}):Play()

        task.wait(step)
    end

    humanoid.WalkSpeed = originalSpeed
    TweenService:Create(img, TweenInfo.new(1), {ImageTransparency = 1}):Play()
    TweenService:Create(dark, TweenInfo.new(1), {BackgroundTransparency = 1}):Play()

    task.delay(1, function()
        img:Destroy()
        dark:Destroy()
        sound:Destroy()
    end)
end

--=== Chạy hiệu ứng song song với Dread422 ===--
task.spawn(DreadClockEffect)
wait(1)
--=== Load Dread422 script ===--
loadstring(game:HttpGet("https://raw.githubusercontent.com/eoyoustme/Script/refs/heads/main/Dread422"))()
