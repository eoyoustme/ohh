local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

local activated = false

local function PlayJumpscare()
	if activated then return end
	activated = true

	task.wait(2)

	local gui = Instance.new("ScreenGui")
	gui.Name = "JumpscareOverlay"
	gui.IgnoreGuiInset = true
	gui.DisplayOrder = 999999
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")

	local img = Instance.new("ImageLabel")
	img.Size = UDim2.new(1, 0, 1, 0)
	img.BackgroundTransparency = 1
	img.BorderSizePixel = 0
	img.ImageTransparency = 0
	img.ScaleType = Enum.ScaleType.Stretch
	img.Parent = gui

	local jumpscareImage1 = "rbxassetid://94547864377343"
	local jumpscareImage2 = "rbxassetid://132173691110215"

	-- fade-in
	img.Image = jumpscareImage1
	TweenService:Create(img, TweenInfo.new(1.6), {ImageTransparency = 1}):Play()

	-- flash
	local start = tick()
	while tick() - start < 1.6 do
		img.Image = jumpscareImage1
		task.wait()
		img.Image = jumpscareImage2
		task.wait()
	end
end

-- chỉ khi máu <= 0
humanoid.HealthChanged:Connect(function(hp)
	if hp <= 0 then
		PlayJumpscare()
	end
end)
